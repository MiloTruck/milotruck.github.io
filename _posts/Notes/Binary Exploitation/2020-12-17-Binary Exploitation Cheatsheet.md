---
title: "Binary Exploitation Cheatsheet"
excerpt: Some notes for pwn challenges in CTFs.
categories: Blog
--- 

# Cheatsheet
## Calling Convention

| Arch          | Registers                   |
|---------------|-----------------------------|
| Linux (x64)   | `rdi, rsi, rdx, rcx, r8, r9`|
| Windows (x64) | `rcx, rdx, r8, r9`          |

## pwntools

| Item               | Code                                                    |
|--------------------|---------------------------------------------------------|
| Shellcode          | `shellcode = asm(shellcraft.sh())`                      |
| Strings            | `binsh = libc.search('/bin/sh\x00;).next()`             |
| Gadgets            | `gadget = exe.search(asm('pop rdi; ret')).next()`       |
| Address of Section | `data = exe.get_section_by_name('.data').header.sh_addr`|

## ret2syscall
* `execve(/bin/sh)`
    * 64-bit: `rax = 59, rdi = /bin/sh, rsi = 0, rdx = 0`
    * 32-bit: `eax = 11, ebx = /bin/sh, ecx = 0, edx = 0`
* [Syscall Table](https://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md)
